import{a as q}from"./chunk-FAUQFWYB.js";import{a as U,b as c,c as D,d as G,e as I,f as A,g as B,j as V,k as j}from"./chunk-K6HC6ABD.js";import{G as N}from"./chunk-65T2XKK6.js";import{e as L,g as R,h as T,k,n as M}from"./chunk-YGVZ7NKW.js";import{$a as d,$b as E,Da as l,Qa as S,V as m,_a as u,aa as x,ba as F,db as h,eb as o,fb as r,gb as p,ka as _,ma as C,mb as y,o as w,ob as f,ub as b,wb as a,xb as v}from"./chunk-PMUFEJA4.js";function z(t,n){if(t&1&&(o(0,"div",6),x(),o(1,"svg",19),p(2,"path",20),r(),F(),o(3,"span"),a(4),r()()),t&2){let i=f();l(4),v(i.errorMessage())}}function H(t,n){if(t&1&&(o(0,"span",12),a(1),r()),t&2){let i=f();l(),v(i.formUtils.getFieldError(i.loginForm,"email"))}}function W(t,n){if(t&1&&(o(0,"span",12),a(1),r()),t&2){let i=f();l(),v(i.formUtils.getFieldError(i.loginForm,"password"))}}function J(t,n){t&1&&(p(0,"span",21),a(1," Iniciando sesi\xF3n... "))}function K(t,n){t&1&&a(0," Iniciar Sesi\xF3n ")}var P=class t{fb=m(V);authService=m(N);router=m(R);route=m(L);loginForm;returnUrl="/simpsons";loginTrigger=_(null);loginResource=M({params:()=>this.loginTrigger(),stream:({params:n})=>n?this.authService.loginWithEmail(n.email,n.password):w(null)});formUtils=q;constructor(){this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/simpsons",this.loginForm=this.fb.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(6)]]}),C(()=>{this.loginResource.hasValue()&&this.loginResource.value()&&(console.log("Login exitoso, navegando a:",this.returnUrl),this.router.navigateByUrl(this.returnUrl))})}onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let{email:n,password:i}=this.loginForm.value;this.loginTrigger.set({email:n,password:i})}loading=this.loginResource.isLoading;errorMessage=()=>{let n=this.loginResource.error();if(!n)return"";let i=n.code||"";return{"auth/invalid-email":"El correo electr\xF3nico no es v\xE1lido","auth/user-disabled":"El usuario ha sido deshabilitado","auth/user-not-found":"No existe un usuario con este correo","auth/wrong-password":"Contrase\xF1a incorrecta","auth/invalid-credential":"Credenciales inv\xE1lidas"}[i]||"Error al iniciar sesi\xF3n"};get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["app-login"]],decls:31,vars:10,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-linear-to-br","from-primary","to-secondary","p-4"],[1,"card","w-full","max-w-md","bg-base-100","shadow-2xl"],[1,"card-body"],[1,"text-center","mb-6"],[1,"text-3xl","font-bold","text-primary","mb-2"],[1,"text-base-content/70"],[1,"alert","alert-error","mb-4"],[3,"ngSubmit","formGroup"],[1,"form-control","mb-6"],[1,"label"],[1,"label-text"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"input","input-bordered","w-full","placeholder:opacity-25"],[1,"block","text-red-500","text-sm","mt-1"],["type","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",1,"input","input-bordered","w-full","placeholder:opacity-25"],[1,"form-control","mt-6"],["type","submit",1,"btn","btn-primary","w-full",3,"disabled"],[1,"text-center","mt-4"],[1,"text-sm","text-base-content/70"],["routerLink","/register",1,"link","link-primary","font-semibold"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading","loading-spinner","loading-sm"]],template:function(i,e){if(i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),a(5,"\xA1Bienvenido!"),r(),o(6,"p",5),a(7,"Inicia sesi\xF3n para continuar"),r()(),u(8,z,5,1,"div",6),o(9,"form",7),y("ngSubmit",function(){return e.onSubmit()}),o(10,"div",8)(11,"label",9)(12,"span",10),a(13,"Correo electr\xF3nico"),r()(),p(14,"input",11),u(15,H,2,1,"span",12),r(),o(16,"div",8)(17,"label",9)(18,"span",10),a(19,"Contrase\xF1a"),r()(),p(20,"input",13),u(21,W,2,1,"span",12),r(),o(22,"div",14)(23,"button",15),u(24,J,2,0)(25,K,1,0),r()()(),o(26,"div",16)(27,"p",17),a(28," \xBFNo tienes cuenta? "),o(29,"a",18),a(30," Reg\xEDstrate aqu\xED "),r()()()()()()),i&2){let s,g;l(8),d(e.loginResource.error()?8:-1),l(),h("formGroup",e.loginForm),l(5),b("input-error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),l(),d((s=e.loginForm.get("email"))!=null&&s.invalid&&((s=e.loginForm.get("email"))!=null&&s.touched)?15:-1),l(5),b("input-error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),l(),d((g=e.loginForm.get("password"))!=null&&g.invalid&&((g=e.loginForm.get("password"))!=null&&g.touched)?21:-1),l(2),h("disabled",e.loading()||e.loginForm.invalid),l(),d(e.loading()?24:25)}},dependencies:[E,j,I,U,D,G,B,A,k,T],encapsulation:2})};export{P as Login};
